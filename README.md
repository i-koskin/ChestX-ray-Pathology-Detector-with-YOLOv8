# üî¨ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–∞—Ç–æ–ª–æ–≥–∏–π –Ω–∞ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏—Ö —Å–Ω–∏–º–∫–∞—Ö –≥—Ä—É–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ NIH ChestX-ray14 (BBox) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ YOLOv8

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![YOLOv8](https://img.shields.io/badge/YOLOv8-8.0+-red.svg)](https://ultralytics.com/)


## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì• –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω—É–∂–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ images_*.tar.gz
- üßπ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —á–∏—Å—Ç–æ–≥–æ YOLO-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞
- ‚öñÔ∏è –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –º–æ–¥–µ–ª—å —Å–æ –≤—Å–µ–º–∏ —Ç–∏–ø–∞–º–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π vs –ë–∏–Ω–∞—Ä–Ω–∞—è –º–æ–¥–µ–ª—å (Abnormal / Normal)
- üöÄ –û–±—É—á–µ–Ω–∏–µ YOLOv8 (nano/small/medium)
- üìä –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (mAP50, mAP50-95)

## üò¢ –ü—Ä–æ–±–ª–µ–º–∞

–ò—Å—Ö–æ–¥–Ω–∞—è –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∏–∑–∫–∏–π mAP50 (~0.2) –∏–∑-–∑–∞ –º–∞–ª–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

## üìù –†–µ—à–µ–Ω–∏–µ

–ü–µ—Ä–µ—Ö–æ–¥ –∫ –±–∏–Ω–∞—Ä–Ω–æ–π –¥–µ—Ç–µ–∫—Ü–∏–∏ ("–ø–∞—Ç–æ–ª–æ–≥–∏—è –µ—Å—Ç—å / –Ω–µ—Ç")


## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

      ChestX-ray-Pathology-Detector-with-YOLOv8/
      ‚îú‚îÄ‚îÄ chestxray_yolo/              # –ü–∞–ø–∫–∞ —Å —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ YOLO
      ‚îÇ  ‚îú‚îÄ‚îÄ images/
      ‚îÇ  ‚îú‚îÄ‚îÄ labels/
      ‚îÇ  ‚îî‚îÄ‚îÄ data.yaml
      ‚îÇ
      ‚îú‚îÄ‚îÄ dataset/ 
      ‚îÇ  ‚îî‚îÄ‚îÄ images/                   # –ü–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ BBox_List_2017.csv
      ‚îÇ
      ‚îú‚îÄ‚îÄ runs/                  
      ‚îÇ  ‚îî‚îÄ‚îÄ detect/             
      ‚îÇ     ‚îî‚îÄ‚îÄ train/
      ‚îÇ        ‚îî‚îÄ‚îÄ weights/
      ‚îÇ           ‚îî‚îÄ‚îÄ best.pt            # –î–æ–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å YOLOv8
      ‚îÇ
      ‚îú‚îÄ‚îÄ dataset_prepare.py             # –ú–æ–¥—É–ª—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ (8 –∫–ª–∞—Å—Å–æ–≤)
      ‚îú‚îÄ‚îÄ dataset_binary_prepare.py      # –ú–æ–¥—É–ª—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞—Ç–∞—Å–µ—Ç–∞ (1 –∫–ª–∞—Å—Å) - –ë–∏–Ω–∞—Ä–Ω–∞—è –¥–µ—Ç–µ–∫—Ü–∏—è: "–ø–∞—Ç–æ–ª–æ–≥–∏—è –µ—Å—Ç—å / –Ω–µ—Ç"
      ‚îú‚îÄ‚îÄ extract_bbox_images.py         # –ú–æ–¥—É–ª—å –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è bbox –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
      ‚îú‚îÄ‚îÄ train_model.py                 # –ú–æ–¥—É–ª—å –∑–∞–ø—É—Å–∫–∞ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ YOLOv8
      ‚îú‚îÄ‚îÄ visualize_multiclass.py.py     # –ú–æ–¥—É–ª—å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–∏ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –ø–∞–ø–∫–µ results/ *
      ‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
      ‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–∫–∏ results/ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

      *
      results/                  
      ‚îú‚îÄ‚îÄ images/ 
      ‚îÇ  ‚îî‚îÄ‚îÄ patient_chest_xray.jpg   # –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å —Ä–∞–º–∫–∞–º–∏
      ‚îú‚îÄ‚îÄ labels/
      ‚îÇ  ‚îî‚îÄ‚îÄ patient_chest_xray.txt  # —Ñ–æ—Ä–º–∞—Ç: class_id x_c y_c w h confidence
      ‚îî‚îÄ‚îÄ json/
         ‚îî‚îÄ‚îÄ patient_chest_xray.json # –ø—Ä–µ–¥–∫–∞–∑–∞–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON

## üìÑ –ü—Ä–∏–º–µ—Ä patient_chest_xray.txt

```txt
2 0.450000 0.600000 0.200000 0.300000 0.874321
6 0.750000 0.300000 0.100000 0.150000 0.642109
```

## üìÑ –ü—Ä–∏–º–µ—Ä patient_chest_xray.json

```json
[
  {
    "class_id": 2,
    "class_name": "Effusion",
    "confidence": 0.8743,
    "bbox_xyxy": [120.0, 200.0, 300.0, 400.0],
    "bbox_cxcywh": [210.0, 300.0, 180.0, 200.0]
  },
  {
    "class_id": 6,
    "class_name": "Pneumonia",
    "confidence": 0.6421,
    "bbox_xyxy": [400.0, 150.0, 500.0, 250.0],
    "bbox_cxcywh": [450.0, 200.0, 100.0, 100.0]
  }
]
```

## üñºÔ∏è –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏

      ChestX-ray-Pathology-Detector-with-YOLOv8/
            ‚îî‚îÄ‚îÄ runs/                  
               ‚îî‚îÄ‚îÄ detect/             
                  ‚îî‚îÄ‚îÄ train/

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/i-koskin/ChestX-ray-Pathology-Detector-with-YOLOv8.git
cd ChestX-ray-Pathology-Detector-with-YOLOv8
```
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
py -m venv venv
```
```bash
source venv/bin/activate  # Linux/MacOS
```
```bash
# –∏–ª–∏
venv\Scripts\activate  # Windows
```
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install -r requirements.txt
```

## üíªÔ∏è –ü–æ—Ä—è–¥–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ bbox –∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

```bash
python extract_bbox_images.py
```
### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏:

```bash
python dataset_prepare.py
```
### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python train_model.py --dataset_dir chestxray_yolo --model_size s --epochs 50 --imgsz 640 --batch 16
```
‚öôÔ∏è *–ê—Ä–≥—É–º–µ–Ω—Ç—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏:*

<p align="left">
<img src="assets/train_model_command_line.JPG")>
</p>

### 4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏:

```bash
python visualize_multiclass.py
```
## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

–î–∞—Ç–∞—Å–µ—Ç: [NIH ChestX-ray14 Dataset](https://nihcc.app.box.com/v/ChestXray-NIHCC)

BBox –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏: [BBox_List_2017.csv](https://nihcc.app.box.com/v/ChestXray-NIHCC/file/219760940956)
